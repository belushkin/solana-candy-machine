# Solana candy machine

## Mint your NFT collection on Solana

## Examples
- https://github.com/exiled-apes/candy-machine-mint
- https://github.com/kevinfaveri/solana-candy-factory
- https://github.com/buildspace/nft-drop-starter-project


## Prerequisites

- Solana itself: https://solana.com/
- All is done on metaplex https://www.metaplex.com/
- Solana Candy Machine V2: https://www.alchemy.com/overviews/candy-machine-v2
- Phantom wallet: https://phantom.app/
- Install git, node, yarn, ts-node

```
git version
> git version 2.31.1 (or higher!)

node --version
> v16.17.0 (or higher, below v17 -- we found that node v16 works best. Make sure it's the LTS version)

yarn --version
> 1.22.11 (or higher!)

ts-node --version
> v10.2.1 (or higher!)
```

- Install Solana:
```
sh -c "$(curl -sSfL https://release.solana.com/stable/install)"
solana --version
```

- Set solana devnet
```
solana config set --url devnet
solana config get
```

- Install sugar
```
sudo apt install libudev-dev pkg-config unzip
bash <(curl -sSf https://sugar.metaplex.com/install.sh)
sugar
```

- Check assets
- https://docs.metaplex.com/developer-tools/sugar/guides/preparing-assets
- 2048x2048 png
- collection.json vs collection.png
- Note: Only PNGs are supported right now via the CLI.
- Storage: (https://bundlr.network/ and https://www.arweave.org/) or https://www.pinata.cloud/ or https://nft.storage/

- Create API keys for storages (needed later)

- Generate keys:
```
solana-keygen new --outfile ~/.config/solana/devnet.json
solana config set --keypair ~/.config/solana/devnet.json
solana config get
```

- Check balance
```
solana balance
solana airdrop 2
```

- Configure your candy machine
```
sugar create-config
```

`price`: The price of each NFT.

`number`: How many NFTs you want to deploy. This needs to match the number of image + json pairs or stuff will break later.

`solTreasuryAccount`: This is your wallet address, it's where the proceedings from SOL payments will go.

`goLiveDate`: When you want the minting to start.

`storage`: This is where your NFTs will be stored.

The only thing you'll need to change here is your wallet address. If you're deploying more than 3 NFTs, update the number! You can deploy up to *10 NFTs on the devnet*.


- Upload NFT will generate `cache.json`
```
sugar upload
```

- Deploy NFT
```
sugar deploy
```

- Verify NFTs

```
sugar verify
```

- Update candy machine config (if you want)
- Change `config.json`
```
sugar update
```

- Create .env.local

```
REACT_APP_CANDY_MACHINE_ID=YOUR_CANDY_MACHINE_ID
REACT_PUBLIC_SOLANA_NETWORK=devnet
REACT_APP_SOLANA_RPC_HOST=https://metaplex.devnet.rpcpool.com/

```
`REACT_APP_CANDY_MACHINE_ID` - This is the address I asked you to keep handy. If you've lost it, it can be found in the cache.json JSON file, look for the value associated with the candyMachine key.

`REACT_PUBLIC_SOLANA_NETWORK` - Set this to devnet as this is just the network in which we are accessing our candy machine from

`REACT_APP_SOLANA_RPC_HOST` - This is pretty much the same as above. Since we are accessing out Candy Machine on devnet we need to point the RPC to that devnet link which is https://explorer-api.devnet.solana.com

- In Phantom go to Settings → Change Network → and choose "Devnet". Our candy machine lives on devnet so we need to make sure our wallet is on devnet as well!

- A note on changing your NFTs
Let's say you don't like the NFT collection you used for testing and got a better idea. You need to be careful here! Whenever you change your collection, you need to follow the same steps from earlier to deploy the NFTs.

```
Delete the cache.json file that was generated by the Metaplex CLI's candy machine commands.

Change up your NFT files to be whatever you want!

Run Metaplex's upload command via the CLI to upload the NFTs and create a new candy machine.

Run Metaplex's verify command via the CLI to make sure the NFTs were uploaded and the candy machine was properly configured.

Update your .env.local file with the new address.
```

